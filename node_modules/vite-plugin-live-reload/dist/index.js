'use strict';

Object.defineProperty(exports, '__esModule', { value: true });

var chokidar = require('chokidar');
var chalk = require('chalk');
var path = require('path');

function _interopDefaultLegacy (e) { return e && typeof e === 'object' && 'default' in e ? e : { 'default': e }; }

var chokidar__default = /*#__PURE__*/_interopDefaultLegacy(chokidar);
var chalk__default = /*#__PURE__*/_interopDefaultLegacy(chalk);
var path__default = /*#__PURE__*/_interopDefaultLegacy(path);

function getShortName(file, root) {
  return file.startsWith(root + "/") ? path__default['default'].posix.relative(root, file) : file;
}
var index = (paths, config = {}) => ({
  name: "vite-plugin-live-reload",
  configureServer({ws, config: {root: viteRoot, logger}}) {
    const root = config.root || viteRoot;
    const reload = (path2) => {
      var _a;
      ws.send({type: "full-reload", path: config.alwaysReload ? "*" : path2});
      if ((_a = config.log) != null ? _a : true) {
        logger.info(chalk__default['default'].green(`page reload `) + chalk__default['default'].dim(getShortName(path2, root)), {clear: true, timestamp: true});
      }
    };
    chokidar__default['default'].watch(paths, {cwd: root, ignoreInitial: true, ...config}).on("add", reload).on("change", reload);
  }
});

exports.default = index;
//# sourceMappingURL=index.js.map
